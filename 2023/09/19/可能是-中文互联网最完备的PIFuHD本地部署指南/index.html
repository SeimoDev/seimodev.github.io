
<!DOCTYPE html>
<html lang="zh-cn" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>(可能是)中文互联网最完备的PIFuHD本地部署指南 - Seimo&#39;s Blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Seimo博客,"> 
    <meta name="description" content="0x0 什么是PIFuHD ?PIFuHD：用于高分辨率 3D 人体数字化的多级像素对齐隐式函数，基于Shunsuke Saito, Tomas, Simon, Jason Saragih, Han,"> 
    <meta name="author" content="Seimo"> 
    <link rel="alternative" href="atom.xml" title="Seimo&#39;s Blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="(可能是)中文互联网最完备的PIFuHD本地部署指南 - Seimo&#39;s Blog"/>
    <meta name="twitter:description" content="0x0 什么是PIFuHD ?PIFuHD：用于高分辨率 3D 人体数字化的多级像素对齐隐式函数，基于Shunsuke Saito, Tomas, Simon, Jason Saragih, Han,"/>
    
    
    
    
    <meta property="og:site_name" content="Seimo&#39;s Blog"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="(可能是)中文互联网最完备的PIFuHD本地部署指南 - Seimo&#39;s Blog"/>
    <meta property="og:description" content="0x0 什么是PIFuHD ?PIFuHD：用于高分辨率 3D 人体数字化的多级像素对齐隐式函数，基于Shunsuke Saito, Tomas, Simon, Jason Saragih, Han,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

    <script>window.searchDbPath = "/search.xml";</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">Seimo&#39;s Blog</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://blog.seimo.cn"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">(可能是)中文互联网最完备的PIFuHD本地部署指南</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">(可能是)中文互联网最完备的PIFuHD本地部署指南</h1>
        <div class="stuff">
            <span>九月 19, 2023</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/PIFuHD/" rel="tag">PIFuHD</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag">深度学习</a></li></ul>


        </div>
        <div class="content markdown">
            <h2 id="0x0-什么是PIFuHD"><a href="#0x0-什么是PIFuHD" class="headerlink" title="0x0 什么是PIFuHD ?"></a>0x0 什么是PIFuHD ?</h2><p><a target="_blank" rel="noopener" href="https://shunsukesaito.github.io/PIFuHD/">PIFuHD</a>：用于高分辨率 3D 人体数字化的多级像素对齐隐式函数，基于Shunsuke Saito, Tomas, Simon, Jason Saragih, Hanbyul Joo, University of Southern California, Facebook Reality Labs, Facebook AI Research等研究人员及企业在2020年四月发表在<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2004.00452.pdf">arxiv上的论文</a>，使用Python打造，可以通过深度学习计算的方式将平面2D人体照片转换为3D空间模型。</p>
<h2 id="0x1-环境准备"><a href="#0x1-环境准备" class="headerlink" title="0x1 环境准备"></a>0x1 环境准备</h2><h3 id="硬件配置："><a href="#硬件配置：" class="headerlink" title="硬件配置："></a>硬件配置：</h3><ul>
<li>显卡：RTX 4060 Laptop</li>
<li>CPU：Intel i9-13900HX</li>
<li>内存：32GB</li>
</ul>
<h3 id="软件配置："><a href="#软件配置：" class="headerlink" title="软件配置："></a>软件配置：</h3><ul>
<li>操作系统：Ubuntu 22.04.3 LTS</li>
<li>显卡驱动：NVIDIA-Linux-x86_64-525.125.06</li>
<li>CUDA版本：11.8</li>
<li>cudnn版本：8.9.5</li>
<li>python版本：3.10</li>
<li>pytorch版本：1.12.0</li>
<li>编译器版本：gcc 9.4.0</li>
</ul>
<h2 id="0x2-环境准备"><a href="#0x2-环境准备" class="headerlink" title="0x2 环境准备"></a>0x2 环境准备</h2><h3 id="安装Ubuntu22-04"><a href="#安装Ubuntu22-04" class="headerlink" title="安装Ubuntu22.04"></a>安装Ubuntu22.04</h3><p>在<a target="_blank" rel="noopener" href="https://cn.ubuntu.com/download/desktop">Ubuntu官网</a>下载安装镜像，使用UltraISO等软件制作启动U盘，在BIOS中设置U盘启动，进入Ubuntu安装界面，选择安装Ubuntu，一路默认安装即可，注意勾选“安装专有的硬件驱动”。由于虚拟机无法使用CUDA，所以请<strong>不要</strong>使用虚拟机安装！！！</p>
<h3 id="安装显卡驱动"><a href="#安装显卡驱动" class="headerlink" title="安装显卡驱动"></a>安装显卡驱动</h3><p>安装完成Ubuntu后，打开终端，输入命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br><span class="line">ubuntu-drivers list</span><br></pre></td></tr></table></figure>
<p>此时系统会列出适用于当前设备的显卡驱动，比如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nvidia-driver-535-server-open, (kernel modules provided by linux-modules-nvidia-535-server-open-generic-hwe-22.04)</span><br><span class="line">nvidia-driver-525-server, (kernel modules provided by linux-modules-nvidia-525-server-generic-hwe-22.04)</span><br><span class="line">nvidia-driver-535, (kernel modules provided by linux-modules-nvidia-535-generic-hwe-22.04)</span><br><span class="line">nvidia-driver-535-server, (kernel modules provided by linux-modules-nvidia-535-server-generic-hwe-22.04)</span><br><span class="line">nvidia-driver-525, (kernel modules provided by linux-modules-nvidia-525-generic-hwe-22.04)</span><br><span class="line">nvidia-driver-525-open, (kernel modules provided by linux-modules-nvidia-525-open-generic-hwe-22.04)</span><br><span class="line">nvidia-driver-535-open, (kernel modules provided by linux-modules-nvidia-535-open-generic-hwe-22.04)</span><br><span class="line"></span><br><span class="line">//通常会列出多个版本的驱动，建议选择不带任何后缀的版本</span><br></pre></td></tr></table></figure>
<p>选择合适的版本运行，比如</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-driver-535</span><br><span class="line">//注意将驱动名称替换为上一条指令输出的结果</span><br></pre></td></tr></table></figure>
<p>进行安装</p>
<h3 id="安装CUDA"><a href="#安装CUDA" class="headerlink" title="安装CUDA"></a>安装CUDA</h3><p><strong>注意！注意！注意！</strong> ，由于需要用到 <code>openpose</code>，而<code>openpose</code>年久未修，建议最高cuda版本为<strong>11.8</strong>，高于此版本可能会出现bug。</p>
<p>首先，在终端中运行<code>nvidia-smi</code>，查看显卡支持的最高cuda版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 525.125.06   Driver Version: 525.125.06   CUDA Version: 12.0     |</span><br><span class="line">|-------------------------------+----------------------+----------------------+</span><br><span class="line">| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|                               |                      |               MIG M. |</span><br><span class="line">|===============================+======================+======================|</span><br><span class="line">|   0  NVIDIA GeForce ...  Off  | 00000000:01:00.0  On |                  N/A |</span><br><span class="line">| N/A   45C    P8     3W / 115W |    420MiB /  8188MiB |      1%      Default |</span><br><span class="line">|                               |                      |                  N/A |</span><br><span class="line">+-------------------------------+----------------------+----------------------+</span><br><span class="line">                                                                               </span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                                  |</span><br><span class="line">|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |</span><br><span class="line">|        ID   ID                                                   Usage      |</span><br><span class="line">|=============================================================================|</span><br><span class="line">|    0   N/A  N/A      1848      G   /usr/lib/xorg/Xorg                187MiB |</span><br><span class="line">|    0   N/A  N/A      2010      G   /usr/bin/gnome-shell               93MiB |</span><br><span class="line">|    0   N/A  N/A     43583      G   ...RendererForSitePerProcess      136MiB |</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到<code>CUDA Version: 12.0</code>，就是说当前显卡支持的最大cuda版本是12.0,考虑到前文提到的兼容性问题，我们选择安装<code>cuda11.8</code>。</p>
<p>进入<a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-toolkit-archive">CUDA Toolkit Archive</a>，选择合适的版本号，此处以<code>11.8.0</code>为例。</p>
<p>点击<code>CUDA Toolkit 11.8.0</code>，跳转安装页面，依次选择<code>Linux -&gt; x86_64 -&gt; Ubuntu-22.04 -&gt; runfile(local)</code>然后分别运行下方显示的两条指令。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run</span><br><span class="line">sudo sh cuda_11.8.0_520.61.05_linux.run</span><br><span class="line"></span><br><span class="line">//不同版本安装指令可能不同，以页面具体显示为准</span><br></pre></td></tr></table></figure>
<p>在安装过程中，会询问你是否接受协议，输入accept，然后弹出安装选项，需要<strong>取消勾选</strong>显卡驱动。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[]Driver</span><br></pre></td></tr></table></figure>
<p>安装完成后，需要配置环境变量，打开~&#x2F;.bashrc文件，添加如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/usr/local/cuda-11.8/bin</span><br><span class="line">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-11.8/lib64</span><br><span class="line"></span><br><span class="line">//其他版本CUDA请自行将11.8改成自己的版本</span><br></pre></td></tr></table></figure>
<p>最后重载:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<h3 id="安装cuDNN"><a href="#安装cuDNN" class="headerlink" title="安装cuDNN"></a>安装cuDNN</h3><p>在<a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-11-8-0-download-archive?target_os=Linux&target_arch=x86_64&Distribution=Ubuntu&target_version=22.04&target_type=runfile_local">官网</a>先登录NVIDIA，然后点击<code>Download cuDNN</code>并勾选<code>I Agree To the Terms of the cuDNN Software License Agreement</code>，这里只显示11.x和12.x，如果需要历史版本就在文末进入存档版本。这里下载11.x的 v8.9.5版本，下载<code>Local Installer for Ubuntu22.04 x86_64 (Deb)</code>安装包。</p>
<p>接着安装zliblg</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zlib1g</span><br></pre></td></tr></table></figure>
<p>安装cudnn包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i cudnn-local-repo-ubuntu2204-8.9.5.29_1.0-1_amd64.deb</span><br><span class="line">//不同版本记得修改版本号</span><br></pre></td></tr></table></figure>
<p>安装结束后会提示安装key，直接复制运行弹出的命令即可，以下命令仅为示例，以自己终端输出的内容为准。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /var/cudnn-local-repo-ubuntu2204-8.9.5.29/cudnn-local-72322D7F-keyring.gpg /usr/share/keyrings/</span><br></pre></td></tr></table></figure>
<p>更新库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<p>查看libcudnn8版本，下列命令均需要根据这个版本号修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-cache policy libcudnn8</span><br></pre></td></tr></table></figure>
<p>得到输出结果，包含以下内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">候选： 8.9.5.29-1+cuda11.8</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>记下版本号并在下面命令中替换。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libcudnn8=8.9.5.29-1+cuda11.8</span><br><span class="line">sudo apt-get install libcudnn8-dev=8.9.5.29-1+cuda11.8</span><br><span class="line">sudo apt-get install libcudnn8-samples=8.9.5.29-1+cuda11.8</span><br></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>运行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libfreeimage3 libfreeimage-dev</span><br><span class="line">cp -r /usr/src/cudnn_samples_v8/ $HOME</span><br><span class="line">cd $HOME/cudnn_samples_v8/mnistCUDNN</span><br><span class="line">make clean &amp;&amp; make</span><br><span class="line">./mnistCUDNN</span><br></pre></td></tr></table></figure>

<p>得到输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Test passed!</span><br></pre></td></tr></table></figure>
<p>即为安装成功。</p>
<h2 id="0x2-部署PIFuHD代码"><a href="#0x2-部署PIFuHD代码" class="headerlink" title="0x2 部署PIFuHD代码"></a>0x2 部署PIFuHD代码</h2><h3 id="拉取源码"><a href="#拉取源码" class="headerlink" title="拉取源码"></a>拉取源码</h3><p>方法一：使用官方源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/facebookresearch/pifuhd.git</span><br></pre></td></tr></table></figure>
<p>然后将所有文件中的<code>np.int</code>替换为<code>int</code>,所有<code>np.bool</code>替换为<code>bool</code>。</p>
<p>方法二：使用我修改好的的源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/SeimoDev/pifuhd.git</span><br></pre></td></tr></table></figure>
<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install python3-pip python-is-python3</span><br><span class="line">pip install -r requirements.txt </span><br><span class="line">sudo apt-get install freeglut3-dev</span><br></pre></td></tr></table></figure>
<h3 id="下载预训练模型"><a href="#下载预训练模型" class="headerlink" title="下载预训练模型"></a>下载预训练模型</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh ./scripts/download_trained_model.sh</span><br></pre></td></tr></table></figure>
<h3 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a>测试</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh ./scripts/demo.sh</span><br></pre></td></tr></table></figure>
<p>得到输出结果,如果没有报错且正常输出模型展示页面，即为安装成功。</p>
<h2 id="配置openpose"><a href="#配置openpose" class="headerlink" title="配置openpose"></a>配置openpose</h2><h3 id="获取源代码"><a href="#获取源代码" class="headerlink" title="获取源代码"></a>获取源代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/CMU-Perceptual-Computing-Lab/openpose.git</span><br><span class="line">cd openpose/</span><br><span class="line">git submodule update --init --recursive --remote</span><br></pre></td></tr></table></figure>
<h3 id="编译源代码"><a href="#编译源代码" class="headerlink" title="编译源代码"></a>编译源代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cmake-qt-gui</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake-gui ..</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgs.ovh/2023/09/19/IniT.png" alt="IniT.png"></p>
<p>将<code>Where is the source code</code>设置为Openpose源码目录<br>将<code>Where to build binaries</code>设置为build目录<br>点击<code>Configure</code><br><img src="https://i.imgs.ovh/2023/09/19/Ilxp.png" alt="Ilxp.png"></p>
<p>选择<code>Unix Makefiles</code><br>然后点击<code>Finish</code>，关闭后勾选<code>BUILD_PYTHON</code>，取消勾选<code>USE_CUDNN</code>然后点击<code>Generate</code>。<br>待下方输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Configuring done</span><br><span class="line">Generating done</span><br></pre></td></tr></table></figure>
<p>关闭cmake-gui窗口，执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j`nproc`</span><br></pre></td></tr></table></figure>
<p>如果不出意外，这样会自动完成openpose的编译。</p>
<h3 id="下载预训练模型-1"><a href="#下载预训练模型-1" class="headerlink" title="下载预训练模型"></a>下载预训练模型</h3><p>由于官方模型下载服务器Shutdown了，这里提供一个存档，可以自行下载放到models文件夹下</p>
<p><a target="_blank" rel="noopener" href="https://zmqpk-my.sharepoint.com/:u:/g/personal/seimo_seimo_cn/EZlfdWAmNBRPniMFG0tbsEcB_RzqcP0ldRsJq0hTNHqfdQ?e=gHzf5J">下载Models.zip</a></p>
<h3 id="测试-2"><a href="#测试-2" class="headerlink" title="测试"></a>测试</h3><p>运行以下命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./build/examples/openpose/openpose.bin --video examples/media/video.avi</span><br></pre></td></tr></table></figure>
<p>如果成功输出食品并且带有人体骨架即为成功</p>
<h2 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h2><p>恭喜你，截至这里，前期工作已经完成，下面开始正式使用</p>
<p>切换到PIFuHD项目目录，将需要渲染的图片放到<code>sample_images</code>文件夹，然后运行如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python apps/batch_openpose.py -d openpose/ -i sample_images -o sample_images</span><br><span class="line">//如果你的openpose项目目录不在pifuhd/openpose下，请自行修改</span><br><span class="line">python -m apps.simple_test</span><br><span class="line">python apps/clean_mesh.py -f results/pifuhd_final/recon</span><br></pre></td></tr></table></figure>

<p>到此，如果你没有遇到报错，那么恭喜你，你已经成功运行了PIFuHD，并将人体图片转换为了三维模型。</p>
<p>你可以在<code>results/pifuhd_final/recon</code>下找到生成的obj文件，拖入需要的建模程序即可使用。</p>
<p>也可以运行下面这个命令将其渲染为视频展示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m apps.render_turntable -f results/pifuhd_final/recon -ww 512 -hh 512</span><br></pre></td></tr></table></figure>

<h2 id="关于部分报错的处理："><a href="#关于部分报错的处理：" class="headerlink" title="关于部分报错的处理："></a>关于部分报错的处理：</h2><ul>
<li>在进行cmake编译时如遇到报错缺少库文件，请自行搜索相关库安装补全，一般报错时会有提示。</li>
<li>如果在最后生成模型时报错<code>CUDA out of Memory</code>,请降低图片分辨率后在次尝试。实测8GB显存可以渲染96*108分辨率的图片。</li>
</ul>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="https://music.163.com/song/media/outer/url?id=1306112195.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="https://music.163.com/song/media/outer/url?id=1923219808.mp3"></li>
                        
                    
                        
                            <li title="2" data-url="https://music.163.com/song/media/outer/url?id=32317208.mp3"></li>
                        
                    
                        
                            <li title="3" data-url="https://music.163.com/song/media/outer/url?id=5221167.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
        
    <div id="gitalk-container" class="comment link"
		data-enable="true"
        data-ae="true"
        data-ci="ef141b3516bdecc5cdcc"
        data-cs="66ae5724c61ddad2dbce419faf242e495f8515fc"
        data-r="seimodev.github.io"
        data-o="SeimoDev"
        data-a="SeimoDev"
        data-d="false"
    >查看评论</div>


    </div>
    
        <div class="side">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0-%E4%BB%80%E4%B9%88%E6%98%AFPIFuHD"><span class="toc-number">1.</span> <span class="toc-text">0x0 什么是PIFuHD ?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">2.</span> <span class="toc-text">0x1 环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">硬件配置：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B6%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="toc-number">2.2.</span> <span class="toc-text">软件配置：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x2-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">3.</span> <span class="toc-text">0x2 环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Ubuntu22-04"><span class="toc-number">3.1.</span> <span class="toc-text">安装Ubuntu22.04</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8"><span class="toc-number">3.2.</span> <span class="toc-text">安装显卡驱动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85CUDA"><span class="toc-number">3.3.</span> <span class="toc-text">安装CUDA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85cuDNN"><span class="toc-number">3.4.</span> <span class="toc-text">安装cuDNN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">3.5.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x2-%E9%83%A8%E7%BD%B2PIFuHD%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">0x2 部署PIFuHD代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E6%BA%90%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">拉取源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="toc-number">4.2.</span> <span class="toc-text">安装依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.</span> <span class="toc-text">下载预训练模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-1"><span class="toc-number">4.4.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEopenpose"><span class="toc-number">5.</span> <span class="toc-text">配置openpose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">5.1.</span> <span class="toc-text">获取源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">5.2.</span> <span class="toc-text">编译源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B-1"><span class="toc-number">5.3.</span> <span class="toc-text">下载预训练模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-2"><span class="toc-number">5.4.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">开始使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E9%83%A8%E5%88%86%E6%8A%A5%E9%94%99%E7%9A%84%E5%A4%84%E7%90%86%EF%BC%9A"><span class="toc-number">7.</span> <span class="toc-text">关于部分报错的处理：</span></a></li></ol>
        </div>
    
</div>


    </div>
</div>
</body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>




</html>
